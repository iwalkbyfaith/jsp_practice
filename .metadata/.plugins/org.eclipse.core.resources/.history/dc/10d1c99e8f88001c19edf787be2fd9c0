<!-- 세션을 활용한 로그인 처리 1 폼

	session_login.jsp
		form을 만들어주세요.
		목적지 : session_login_check.jsp
		post 방식
		id, pw, nickname 3개 정보르ㄹ submit해서 전달
	
	session_login_check.jsp
		form에서 보낸 데이터를 받아서
			아이디 kkk1234, 비번 1111로 온 경우만 session.setAttribute()를 이용해
			session_id에는 전달 받은 아이디를,
			session_pw에는 전달 받은 비밀번호를
			session_nick에는 전달 받은 닉네임을 저장한 다음
			session_wlecome.jsp로 redirect 합니다.
			로그인 실패시 '로그인창으로 돌아가기' 링크만 보이게 해주세요

	session_welcome.jsp는 로그인 성공했을때 볼 창입니다.
		session_login_check.jsp에서 발급한 세션을 이용해 id, nickname 정보를 얻어와서
		닉네임(id)님 로그인을 환영합니다. 라는 문구가 보여지면 성공입니다.
		아래에 a태그로 로그아웃하기 버튼이 있어 session_logout.jsp로 보내줍니다.
		
	session_logout.jsp 로그아웃시 볼 창입니다.
	로그아웃시에 세션을 모두 파기하고나서 session_login.jsp로 리다이렉트 시켜주면 됩니다.
	
	다 만든 경우,
		session_login.jsp를 이미 로그인한 상태로 접근시 welcome으로 리다이렉트
		로그인 안하고 session_welcome.jsp로 갔을시, 로그인 창으로 보내주기


 -->



<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<%
	// 이미 로그인한 쿠키가 남아있는 경우 welcome 페이지로 보내기
	// 근데 로그아웃해서 세션이 만료된 경우도 넣어줘야할 것 같은데... (welcome 페이지애서 null 이 뜨는 현상)
		Cookie[] cookies = request.getCookies();
		String autoLogin = null;
		
		if(cookies != null){
			for(Cookie cookie : cookies){
				autoLogin = cookie.getName();
				if(autoLogin.equals("auto_login")){
					response.sendRedirect("session_welcome.jsp");
				}
			}
		}


%>   
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>

	<h2>로그인 창</h2>
	<form action="session_login_check.jsp" method="post">
		<input type="text" name="id" placeholder="아이디"/><br/>
		<input type="password" name="pw" placeholder="비밀번호"/><br/>
		<input type="text" name="nick" placeholder="닉네임"/><br/>
		<input type="checkbox" name="auto" value="checked"/>자동로그인 &nbsp;
		<input type="submit" value="로그인"/>	
	</form>

</body>
</html>